(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71127,       1701]
NotebookOptionsPosition[     68680,       1657]
NotebookOutlinePosition[     69075,       1673]
CellTagsIndexPosition[     69032,       1670]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"m", ",", "n"}], "]"}]], "Input",
 CellChangeTimes->{{3.8584472216599197`*^9, 3.858447223393093*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"bfcb8005-22c5-4fee-b8aa-c6ae2a390fb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n"}], "}"}], "\[Element]", "PositiveIntegers"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8584397461885767`*^9, 3.858439761233712*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e3588c0d-eee4-4f2e-af49-9f3a079da52f"],

Cell[CellGroupData[{

Cell["Experiment", "Subsection",
 CellChangeTimes->{{3.858447240945939*^9, 
  3.8584472453114223`*^9}},ExpressionUUID->"65ba6b55-0cda-40b5-9173-\
bfd633501c4f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8584440147382317`*^9, 3.858444163610165*^9}, {
   3.858444291919211*^9, 3.858444292208202*^9}, {3.858445221075*^9, 
   3.858445241778583*^9}, {3.858596533821495*^9, 3.85859653498839*^9}, {
   3.85867755893909*^9, 3.8586775640421124`*^9}, {3.858677608619892*^9, 
   3.858677640218102*^9}, {3.85867824281966*^9, 3.858678245261001*^9}, {
   3.858678965454884*^9, 3.8586789807554827`*^9}, {3.858679166972246*^9, 
   3.858679177431501*^9}, 
   3.858679438301207*^9},ExpressionUUID->"944a701a-0fd3-4031-91ff-\
6adb1cb85276"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{"p_", ",", "o_"}], "}"}], "]"}], ":=", 
   RowBox[{"dis", "[", 
    RowBox[{"[", 
     RowBox[{"p", ",", "o"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Life", "[", "alloc_", "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"f", "/@", "alloc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Wait", "[", 
    RowBox[{"w_", ",", " ", "p_", ",", "alloc_"}], "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"w", "[", 
     RowBox[{"[", 
      RowBox[{"Complement", "[", 
       RowBox[{"p", ",", 
        RowBox[{"alloc", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Goal", "[", 
    RowBox[{"w_", ",", " ", "p_", ",", "alloc_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Wait", "[", 
     RowBox[{"w", ",", " ", "p", ",", "alloc"}], "]"}], "+", 
    RowBox[{"Life", "[", "alloc", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.858696921968*^9, 3.858696930001274*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"575ec06b-a8f5-4e82-bb4f-5ee262caec37"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RandomSim", "[", 
    RowBox[{
    "p0_", ",", " ", "o0_", ",", " ", "dis0_", ",", " ", "w0_", ",", " ", 
     "m0_", ",", " ", "n0_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "=", "p0"}], ",", " ", 
       RowBox[{"w", "=", "w0"}], ",", " ", 
       RowBox[{"m", "=", "m0"}], ",", " ", 
       RowBox[{"n", "=", "n0"}], ",", " ", 
       RowBox[{"o", "=", "o0"}], ",", " ", 
       RowBox[{"dis", "=", "dis0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RandomAlloc", "[", 
        RowBox[{"w_", ",", " ", "p_", ",", "o_"}], "]"}], ":=", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{"f", "[", "#1", "]"}], ">", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ",", "#1", 
            ",", "Nothing"}], "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"RandomSample", "[", "p", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"Min", "[", 
                RowBox[{"m", ",", "n"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"RandomSample", "[", "o", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"Min", "[", 
                RowBox[{"m", ",", "n"}], "]"}]}], "]"}], "]"}]}], "}"}], 
          "\[Transpose]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SampleGoal", "[", 
        RowBox[{"w_", ",", " ", "p_", ",", "o_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Goal", "[", 
            RowBox[{"w", ",", " ", "p", ",", "#"}], "]"}], ",", " ", "#"}], 
          "}"}], "&"}], "@", 
        RowBox[{"RandomAlloc", "[", 
         RowBox[{"w", ",", " ", "p", ",", "o"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"smps", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", "n"}], ",", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], " ", "@", 
          RowBox[{"SampleGoal", "[", 
           RowBox[{"w", ",", " ", "p", ",", "o"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "+", "n"}], ")"}], "^", "2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"scores", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "smps"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allocations", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", "smps"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"scores", ",", " ", "allocations"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.858444213414798*^9, 3.8584442237929783`*^9}, {
   3.8584442994010077`*^9, 3.858444300050644*^9}, {3.858445041323862*^9, 
   3.85844504152321*^9}, {3.8584451135192223`*^9, 3.8584451513702087`*^9}, {
   3.858445681515019*^9, 3.8584456953397207`*^9}, {3.8584457442158623`*^9, 
   3.8584457481988907`*^9}, {3.85859682302219*^9, 3.858596841543169*^9}, {
   3.858596880327045*^9, 3.8585968825830803`*^9}, {3.858679033626916*^9, 
   3.858679034179351*^9}, 3.858679113250317*^9, {3.858679226410907*^9, 
   3.858679338732336*^9}, {3.858679778500105*^9, 3.858679827290266*^9}, {
   3.8586848247342243`*^9, 3.8586848247480583`*^9}, {3.858696094350906*^9, 
   3.858696097877801*^9}, {3.8586969875855703`*^9, 3.858696987985085*^9}, {
   3.8586970593931627`*^9, 3.858697085228516*^9}, 3.858697460537973*^9, {
   3.858697511079136*^9, 3.8586975303708076`*^9}, {3.858697622083308*^9, 
   3.858697631879073*^9}, {3.858697778683406*^9, 3.8586977800747538`*^9}, {
   3.8586978215498037`*^9, 3.858697829886444*^9}, {3.8587004687908154`*^9, 
   3.858700468943083*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"02b1a2c8-5fc5-450c-a7a2-9317c384585a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptimalSim", "[", 
     RowBox[{
     "p0_", ",", " ", "o0_", ",", " ", "dis0_", ",", " ", "w0_", ",", " ", 
      "m0_", ",", " ", "n0_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", "p0"}], ",", " ", 
        RowBox[{"w", "=", "w0"}], ",", " ", 
        RowBox[{"m", "=", "m0"}], ",", " ", 
        RowBox[{"n", "=", "n0"}], ",", " ", 
        RowBox[{"o", "=", "o0"}], ",", " ", 
        RowBox[{"dis", "=", "dis0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"m", ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"i_", ",", "j_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<x\>\"", "<>", 
          RowBox[{"ToString", "@", "i"}], "<>", "\"\<d\>\"", " ", "<>", 
          RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<d\>\"", " ", "<>",
           " ", 
          RowBox[{"ToString", "@", "t"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"waitConstr", "[", 
         RowBox[{"w_", ",", " ", "i_"}], "]"}], " ", ":=", "  ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<x\>\"", "<>", 
              RowBox[{"ToString", "@", "i"}], "<>", "\"\<d\>\"", " ", "<>", 
              RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<d\>\"", 
              " ", "<>", " ", 
              RowBox[{"ToString", "@", "t"}]}], "]"}], " ", "==", " ", "0"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "m"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", 
             RowBox[{"w", "+", "1"}], ",", " ", "T"}], "}"}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EvaluateSolution", "[", "alloc_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dis", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], " ", "&"}], 
             " ", "/@", "alloc"}], "]"}], " ", "+", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", 
               RowBox[{"Complement", "[", 
                RowBox[{"p", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", 
                  "alloc"}]}], "]"}], "]"}], "]"}], " ", "//", " ", "Total"}],
             ")"}]}], ")"}], "/", "n"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"obj1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"dis", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "*", 
             RowBox[{"var", "[", 
              RowBox[{"i", ",", "j", ",", "t"}], "]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "  ", "n"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", "  ", "m"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "//", " ", 
          "Flatten"}], " ", "//", " ", "Total"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"obj2", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"w", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "*", " ", 
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", " ", "m"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "//", 
                 " ", "Flatten"}], " ", "//", " ", "Total"}], " ", ")"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], "  ", "//", " ", 
         "Total"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"obj", " ", "=", " ", 
        RowBox[{"obj1", " ", "+", " ", "obj2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"constr", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", "m"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "]"}], 
             " ", "//", " ", "Total"}], ")"}], " ", "<=", " ", "1"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"constr2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], "]"}], " ", "//",
              "Total"}], ")"}], " ", "<=", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "m"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"constr3", " ", "=", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", "m"}], "}"}]}], "]"}], "]"}], " ", "//",
              "Total"}], ")"}], "<=", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"constr4", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"var", "[", 
             RowBox[{"i", ",", "j", ",", "t"}], "]"}], " ", ">=", " ", "0"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "m"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "//", " ", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"constr5", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"waitConstr", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"w", ",", " ", "p"}], "}"}], "]"}]}], " ", "//", " ", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"LinearOptimization", "[", 
         RowBox[{
          RowBox[{"obj1", "+", "obj2"}], ",", " ", 
          RowBox[{
          "constr", "~", "Join", "~", "constr2", "~", "Join", "~", "constr3", 
           "~", "Join", "~", "constr4", "~", "Join", "~", "constr5"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"var", "[", 
               RowBox[{"i", ",", "j", ",", "t"}], "]"}], "\[Element]", " ", 
              "Integers"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", "m"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], "//", 
           "Flatten"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SplitRes", "[", "s_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", "s"}], "//", " ", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", " ", "\"\<x\>\""}], "]"}], "&"}]}], " ", "//",
            " ", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", " ", "\"\<d\>\""}], "]"}], "&"}]}], " ", "//", 
          "ToExpression"}], "//", " ", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExtractAllocation", "[", "res_", "]"}], ":=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SplitRes", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
           " ", 
           RowBox[{"Select", "[", 
            RowBox[{"res", ",", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "1"}], "&"}],
               ")"}]}], "]"}]}], ",", " ", "Last"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"alloc", " ", "=", " ", 
        RowBox[{"ExtractAllocation", "[", "res", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EvaluateSolution", "[", "alloc", "]"}], ",", " ", "alloc"}],
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GreedySim", "[", 
     RowBox[{
     "p0_", ",", " ", "o0_", ",", " ", "dis0_", ",", " ", "w0_", ",", " ", 
      "m0_", ",", " ", "n0_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", "p0"}], ",", " ", 
        RowBox[{"w", "=", "w0"}], ",", " ", 
        RowBox[{"m", "=", "m0"}], ",", " ", 
        RowBox[{"n", "=", "n0"}], ",", " ", 
        RowBox[{"o", "=", "o0"}], ",", " ", 
        RowBox[{"dis", "=", "dis0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"m", "/", "2"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"alc", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Min", "[", 
           RowBox[{"m", ",", "n"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pRm", ",", "oRm"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"Range", "[", "m", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"patients", ",", "organs"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            SubscriptBox["pt", "i"], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SubscriptBox["or", "i"], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NormalEdgeForm", "[", "ed_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ed", "/.", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["_", "i_"], "->", "i"}], "}"}]}], ")"}], "/.", 
         RowBox[{"DirectedEdge", "->", "List"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Zero", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Infinity", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FindPosition", "[", 
         RowBox[{"alloc_", ",", "last_"}], "]"}], ":=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"alloc", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"Min", "[", 
               RowBox[{"last", ",", 
                RowBox[{"Length", "[", "alloc", "]"}]}], "]"}]}], "]"}], 
            "]"}], ",", "0"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PlaceAtLast", "[", 
         RowBox[{"item_", ",", " ", "list_", ",", " ", "last_"}], "]"}], ":=",
         "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "l", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"l", "=", 
            RowBox[{"FindPosition", "[", 
             RowBox[{"list", ",", "last"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "l", "]"}], "==", "0"}], ",", 
             RowBox[{"Return", "[", "list", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"list", ",", 
              RowBox[{
               RowBox[{"Last", "[", "l", "]"}], "->", "item"}]}], "]"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "oRm", "]"}], ">", "0"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "pRm", "]"}], ">", "0"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adj", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"\[Infinity]", ",", 
                    RowBox[{"Length", "[", "oRm", "]"}]}], "]"}], ",", "#1"}],
                    "]"}], "&"}], ")"}], "/@", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"dis", "[", 
                  RowBox[{"[", 
                   RowBox[{"pRm", ",", "oRm"}], "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"Zero", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "pRm", "]"}], ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "oRm", "]"}], "+", 
                  RowBox[{"Length", "[", "pRm", "]"}]}]}], "]"}]}], "]"}], "/.",
              "\[VeryThinSpace]", 
             RowBox[{"{", 
              RowBox[{"0.", "\[Rule]", "\[Infinity]"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"g", "=", 
           RowBox[{"WeightedAdjacencyGraph", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"organs", "[", 
                RowBox[{"[", "oRm", "]"}], "]"}], ",", 
               RowBox[{"patients", "[", 
                RowBox[{"[", "pRm", "]"}], "]"}]}], "]"}], ",", "adj"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"g", "//", "EdgeList"}], "]"}], "==", "0"}], ",", 
            RowBox[{
             RowBox[{"Break", "[", "]"}], ";", 
             RowBox[{"Print", "[", "\"\<Breaking\>\"", "]"}], ";"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mm", "=", 
           RowBox[{"NormalEdgeForm", "/@", 
            RowBox[{"FindMaximumFlow", "[", 
             RowBox[{"g", ",", 
              RowBox[{"patients", "[", 
               RowBox[{"[", "pRm", "]"}], "]"}], ",", 
              RowBox[{"organs", "[", 
               RowBox[{"[", "oRm", "]"}], "]"}], ",", "\"\<EdgeList\>\"", ",", 
              RowBox[{"VertexCapacity", "\[Rule]", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "oRm", "]"}], "+", 
                  RowBox[{"Length", "[", "pRm", "]"}]}]}], "]"}]}]}], 
             "]"}]}]}], ";", 
          RowBox[{"wait", "=", 
           RowBox[{"w", "\[LeftDoubleBracket]", 
            RowBox[{"mm", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}]}], ";", 
          RowBox[{"gains", "=", 
           RowBox[{
            RowBox[{"f", "/@", "mm"}], "-", "wait"}]}], ";", 
          RowBox[{"next", "=", 
           RowBox[{
            RowBox[{"Ordering", "[", 
             RowBox[{"gains", ",", 
              RowBox[{"-", "1"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"alc", "=", 
           RowBox[{"PlaceAtLast", "[", 
            RowBox[{
             RowBox[{"mm", "[", 
              RowBox[{"[", "next", "]"}], "]"}], ",", "alc", ",", 
             RowBox[{"w", "[", 
              RowBox[{"[", "next", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"oRm", "=", 
           RowBox[{"oRm", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"mm", "[", 
                RowBox[{"[", "next", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "->", "Nothing"}], "}"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"pRm", "=", 
           RowBox[{"pRm", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"mm", "[", 
                RowBox[{"[", "next", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "->", "Nothing"}], "}"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"greedy", "=", 
        RowBox[{"Goal", "[", 
         RowBox[{"w", ",", " ", "p", ",", " ", 
          RowBox[{"alc", "/.", 
           RowBox[{"{", 
            RowBox[{"0", "->", "Nothing"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"greedy", " ", "/", " ", "n"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sim", "[", 
     RowBox[{"n0_", ",", " ", "m0_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", "n0"}], ",", " ", 
        RowBox[{"m", "=", "m0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"o", "=", 
        RowBox[{"Range", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"PoissonDistribution", "[", "15", "]"}], ",", "n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pZ", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", "10"}], "]"}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"oZ", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", "10"}], "]"}], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dis", "=", 
        RowBox[{"5", 
         RowBox[{"Ramp", "[", 
          RowBox[{
           RowBox[{"DistanceMatrix", "[", 
            RowBox[{"pZ", ",", "oZ"}], "]"}], "-", "5"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"randomScores", " ", "=", " ", 
        RowBox[{
         RowBox[{"RandomSim", "[", 
          RowBox[{
          "p", ",", " ", "o", ",", " ", "dis", ",", " ", "w", ",", " ", "m", 
           ",", " ", "n"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"optimalScore", " ", "=", " ", 
        RowBox[{
         RowBox[{"OptimalSim", "[", 
          RowBox[{
          "p", ",", " ", "o", ",", " ", "dis", ",", " ", "w", ",", " ", "m", 
           ",", " ", "n"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"greedyScore", " ", "=", " ", 
        RowBox[{"GreedySim", "[", 
         RowBox[{
         "p", ",", " ", "o", ",", " ", "dis", ",", " ", "w", ",", " ", "m", 
          ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Max", "[", "randomScores", "]"}], ",", " ", "greedyScore", 
         ",", " ", "optimalScore"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.85859495011421*^9, 3.858595040146738*^9}, {
   3.858595080843152*^9, 3.858595211766172*^9}, {3.8585954178322783`*^9, 
   3.858595498871726*^9}, {3.85859553371247*^9, 3.8585955461835203`*^9}, {
   3.858595624218296*^9, 3.858595636749614*^9}, {3.858595668987262*^9, 
   3.858595678036394*^9}, {3.858596433193225*^9, 3.858596450191517*^9}, {
   3.858678161793344*^9, 3.85867817395884*^9}, {3.858678210534581*^9, 
   3.8586782114864264`*^9}, {3.85867859540471*^9, 3.858678616928318*^9}, {
   3.8586790630386343`*^9, 3.8586790633407383`*^9}, {3.858679187483774*^9, 
   3.858679189243516*^9}, {3.858679385762171*^9, 3.858679618712492*^9}, {
   3.858679652723298*^9, 3.858679653104444*^9}, {3.858679857962049*^9, 
   3.858679899805685*^9}, {3.858680191634077*^9, 3.858680192119433*^9}, {
   3.858680282188075*^9, 3.8586802853003483`*^9}, {3.858695882715516*^9, 
   3.858695964127771*^9}, {3.8586959993738537`*^9, 3.858696001509858*^9}, {
   3.858696070122368*^9, 3.8586960717578087`*^9}, {3.858696108769792*^9, 
   3.858696129602127*^9}, {3.858696206619341*^9, 3.858696240110775*^9}, {
   3.858696305241816*^9, 3.858696317253625*^9}, {3.858696352365472*^9, 
   3.858696419885723*^9}, {3.858696458902363*^9, 3.858696459425494*^9}, {
   3.858696510592598*^9, 3.858696537738886*^9}, {3.8586966534300127`*^9, 
   3.85869665392712*^9}, {3.858696694076317*^9, 3.858696701772887*^9}, {
   3.8586967972323914`*^9, 3.8586968127100153`*^9}, {3.858697152797353*^9, 
   3.858697153235898*^9}, {3.858697270123612*^9, 3.858697343486486*^9}, {
   3.8586974006299667`*^9, 3.858697401698227*^9}, {3.858697472240014*^9, 
   3.858697473330757*^9}, 3.858697520636342*^9, {3.858697739439624*^9, 
   3.858697741442809*^9}, {3.858697841853018*^9, 3.85869784466154*^9}, {
   3.8587004552374763`*^9, 3.858700461405058*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"15b01b56-b5d5-4c93-8a66-aa3e1040cc0f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.858678417642577*^9, 3.858678472686719*^9}, {
   3.858678517231472*^9, 3.858678519744618*^9}, {3.858678553599695*^9, 
   3.858678577693468*^9}, {3.858678833145101*^9, 3.858678869366407*^9}, 
   3.858679060583838*^9, {3.858680177410387*^9, 
   3.858680188876236*^9}},ExpressionUUID->"9583f919-2f58-40d5-a649-\
096a77c66b72"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sim", "[", 
  RowBox[{"5", ",", " ", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.858680476237008*^9, 3.858680476240081*^9}, 
   3.858683653822701*^9, {3.8586964487086773`*^9, 3.858696451939554*^9}, {
   3.858697485150793*^9, 3.858697486853922*^9}, {3.858697549694015*^9, 
   3.858697550407427*^9}, {3.8587004753464737`*^9, 3.8587005216482563`*^9}, 
   3.858701691393565*^9},ExpressionUUID->"34e01d77-a8ae-4b18-83c0-\
b4ca1b80292d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "63.80901833103434`", ",", "46.948809439077394`", ",", 
   "63.80901833103434`"}], "}"}]], "Output",
 CellChangeTimes->{{3.85869645284126*^9, 3.858696461765678*^9}, {
   3.8586965233212147`*^9, 3.8586965405009937`*^9}, {3.858696687718567*^9, 
   3.858696704476131*^9}, {3.85869727615133*^9, 3.858697294111788*^9}, 
   3.858697326874494*^9, {3.858697394489596*^9, 3.8586974053562307`*^9}, {
   3.8586974762007523`*^9, 3.858697488100726*^9}, 3.858697551274667*^9, 
   3.858697659219804*^9, 3.858697743203381*^9, 3.858697792745376*^9, {
   3.858697835439971*^9, 3.858697846793295*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"fbac354b-b1ea-4188-9e44-caf57e979faa"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.858697514767253*^9, {3.858697905730685*^9, 
   3.858697909324226*^9}},ExpressionUUID->"5298b86f-1365-476f-a70c-\
aa7e91d10fe9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ratios", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", "/", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "@", 
        RowBox[{"Sim", "[", 
         RowBox[{"n", ",", "n"}], "]"}]}], ",", " ", "10"}], "]"}], "//", 
     "Mean"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "5", ",", " ", "50", ",", " ", "5"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8586804799836683`*^9, 3.858680522158287*^9}, {
  3.858680611796393*^9, 3.858680618142186*^9}, {3.8586821114020863`*^9, 
  3.858682113027054*^9}, {3.85869786194001*^9, 3.858697866074374*^9}, {
  3.8586979276029377`*^9, 3.8586979877486677`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"245dd2ea-c2aa-4dab-a94f-90939702aa79"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.3565062438669027`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0204122002150215`", ",", "1.264462487604371`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0782289840436954`", ",", "1.2992825630228775`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1911796077506784`", ",", "1.2681750143711104`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.282777937511916`", ",", "1.2776527918451133`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.394500582368709`", ",", "1.2232963190900108`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4834996398900548`", ",", "1.2521761768789814`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5968431236749425`", ",", "1.2565043526531483`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.653781048313147`", ",", "1.19912746569413`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6601640796025012`", ",", "1.2570957853181892`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.858680499513157*^9, 3.858680569359521*^9, 3.858680769540333*^9, 
   3.858682348911467*^9, 3.858683888224504*^9, 3.858684335752742*^9, 
   3.8586978738940477`*^9, {3.858697955859638*^9, 3.8586979744808083`*^9}, 
   3.8586984567236967`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"e576a9b5-602d-463a-b2fd-243ac687683d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"5", ",", " ", "50", ",", " ", "5"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "ratios"}]}], "}"}], 
      "]"}], ",", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"5", ",", " ", "50", ",", " ", "5"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "ratios"}]}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"Ticks", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", "10", "]"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{"5", ",", " ", "50", ",", " ", "5"}], "]"}]}], "}"}], "]"}],
       ",", " ", "Automatic"}], "}"}]}], ",", " ", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<# patients (n)\>\"", ",", "\"\<Approx Ratio\>\""}], "}"}]}],
    ",", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontSize", "->", "18"}], ",", 
      RowBox[{"FontColor", "->", "Black"}], ",", 
      RowBox[{"FontFamily", "->", "\"\<CMU Sans Serif\>\""}]}], "}"}]}], ",", 
   
   RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", " ", "10"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Dashed"}], ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Random\>\"", ",", " ", "\"\<Greedy\>\""}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{".25", ",", " ", ".8"}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.858681795999518*^9, 3.858681966467224*^9}, {
   3.858682005122922*^9, 3.858682093473817*^9}, {3.858682429435648*^9, 
   3.858682450292967*^9}, {3.8586825016590137`*^9, 3.858682504575211*^9}, {
   3.8586829350445127`*^9, 3.8586829404061327`*^9}, 3.858683017900858*^9, {
   3.858683481699609*^9, 3.858683481973402*^9}, {3.8586845624514112`*^9, 
   3.858684571802701*^9}, {3.858698540941671*^9, 3.858698541150675*^9}, {
   3.8586985833857517`*^9, 3.8586985834593897`*^9}, {3.85869865584599*^9, 
   3.858698657914707*^9}, {3.858698761012998*^9, 3.858698792189597*^9}, {
   3.858698840630872*^9, 3.85869884987004*^9}, {3.858698896465542*^9, 
   3.858698924677594*^9}, {3.858698970947647*^9, 3.8586990361240683`*^9}, {
   3.858699104065928*^9, 3.8586993168670673`*^9}, {3.858699548922701*^9, 
   3.85869966873473*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"7ce1c9c3-1195-4f14-85fb-327189b3df86"],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, {{{}, {}, 
       {RGBColor[0.9, 0.36, 0.054], PointSize[
         NCache[
          Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
        Dashing[{Small, Small}], CapForm["Butt"], 
        LineBox[{{5., 1.}, {10., 1.0204122002150215`}, {15., 
         1.0782289840436954`}, {20., 1.1911796077506784`}, {25., 
         1.282777937511916}, {30., 1.394500582368709}, {35., 
         1.4834996398900548`}, {40., 1.5968431236749425`}, {45., 
         1.653781048313147}, {50., 1.6601640796025012`}}]}, 
       {RGBColor[0.365248, 0.427802, 0.758297], PointSize[
         NCache[
          Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
        Dashing[{Small, Small}], CapForm["Butt"], 
        LineBox[{{5., 1.3565062438669027`}, {10., 1.264462487604371}, {15., 
         1.2992825630228775`}, {20., 1.2681750143711104`}, {25., 
         1.2776527918451133`}, {30., 1.2232963190900108`}, {35., 
         1.2521761768789814`}, {40., 1.2565043526531483`}, {45., 
         1.19912746569413}, {50., 1.2570957853181892`}}]}}, {
       {RGBColor[0.9, 0.36, 0.054], PointSize[
         NCache[
          Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
        Dashing[{Small, Small}], CapForm["Butt"], 
        GeometricTransformationBox[InsetBox[
          FormBox[
           StyleBox[
            GraphicsBox[
             {EdgeForm[None], DiskBox[{0, 0}]}],
            StripOnInput->False,
            GraphicsBoxOptions->{DefaultBaseStyle->Directive[
              PointSize[
               Rational[7, 360]], 
              RGBColor[0.9, 0.36, 0.054], 
              CapForm["Butt"], 
              AbsoluteThickness[1.6], 
              Dashing[{Small, Small}]]}],
           TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{5., 1.}}, {{
         10., 1.0204122002150215`}}, {{15., 1.0782289840436954`}}, {{20., 
         1.1911796077506784`}}, {{25., 1.282777937511916}}, {{30., 
         1.394500582368709}}, {{35., 1.4834996398900548`}}, {{40., 
         1.5968431236749425`}}, {{45., 1.653781048313147}}, {{50., 
         1.6601640796025012`}}}]}, 
       {RGBColor[0.365248, 0.427802, 0.758297], PointSize[
         NCache[
          Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
        Dashing[{Small, Small}], CapForm["Butt"], 
        GeometricTransformationBox[InsetBox[
          FormBox[
           StyleBox[
            GraphicsBox[
             {EdgeForm[None], 
              PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}],
            StripOnInput->False,
            GraphicsBoxOptions->{DefaultBaseStyle->Directive[
              PointSize[
               Rational[7, 360]], 
              RGBColor[0.365248, 0.427802, 0.758297], 
              CapForm["Butt"], 
              AbsoluteThickness[1.6], 
              Dashing[{Small, Small}]]}],
           TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{5., 
         1.3565062438669027`}}, {{10., 1.264462487604371}}, {{15., 
         1.2992825630228775`}}, {{20., 1.2681750143711104`}}, {{25., 
         1.2776527918451133`}}, {{30., 1.2232963190900108`}}, {{35., 
         1.2521761768789814`}}, {{40., 1.2565043526531483`}}, {{45., 
         1.19912746569413}}, {{50., 1.2570957853181892`}}}]}}}, {{}, {}}}, 
    InsetBox[
     TemplateBox[{"\"Random\"", "\"Greedy\""},
      "LineLegend",
      DisplayFunction->(FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.9, 0.36, 0.054], 
                    CapForm["Butt"], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}]], {
                    LineBox[{{0, 10}, {40, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.9, 0.36, 0.054], 
                    CapForm["Butt"], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}, {DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.9, 0.36, 0.054], 
                    CapForm["Butt"], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {40, 10},
                     PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[-0.148] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.365248, 0.427802, 0.758297], 
                    CapForm["Butt"], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}]], {
                    LineBox[{{0, 10}, {40, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.365248, 0.427802, 0.758297], 
                    CapForm["Butt"], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.365248, 0.427802, 0.758297], 
                    CapForm["Butt"], 
                    AbsoluteThickness[1.6], 
                    Dashing[{Small, Small}]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {40, 10},
                     PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[-0.148] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontSize -> 18, FontColor -> GrayLevel[0], FontFamily -> 
          "CMU Sans Serif"}, Background -> Automatic, StripOnInput -> False], 
        TraditionalForm]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                   
                   TemplateBox[<|"color" -> RGBColor[0.9, 0.36, 0.054]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"CapForm", "[", "\"Butt\"", "]"}], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"Dashing", "[", 
                    RowBox[{"{", 
                    RowBox[{"Small", ",", "Small"}], "}"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.365248, 0.427802, 0.758297]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"CapForm", "[", "\"Butt\"", "]"}], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"Dashing", "[", 
                    RowBox[{"{", 
                    RowBox[{"Small", ",", "Small"}], "}"}], "]"}]}], "]"}]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}], ",", 
                    RowBox[{"Offset", "[", "10", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}], ",", 
                    RowBox[{"Offset", "[", "10", "]"}]}], "}"}]}], "}"}]}], 
           ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
                 RowBox[{"FontColor", "\[Rule]", 
                   
                   TemplateBox[<|"color" -> GrayLevel[0]|>, 
                    "GrayLevelColorSwatchTemplate"]}], ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"CMU Sans Serif\""}]}], 
               "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& )], 
     Scaled[{0.25, 0.8}], ImageScaled[{0.5, 0.5}],
     BaseStyle->{FontSize -> Larger},
     FormatType->StandardForm]},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{False, False},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0.9633242177998633},
   DisplayFunction->Identity,
   Frame->{{True, True}, {True, True}},
   FrameLabel->{{
      FormBox["\"Approx Ratio\"", TraditionalForm], None}, {
      FormBox["\"# patients (n)\"", TraditionalForm], None}},
   FrameStyle->Automatic,
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{{0}, {0}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   LabelStyle->{
    FontSize -> 18, FontColor -> GrayLevel[0], FontFamily -> "CMU Sans Serif"},
   Method->{
    "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
     "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& )}},
   PlotRange->{{0, 50.}, {0.9633242177998633, 1.6601640796025012`}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.05], 
      Scaled[0.05]}},
   Ticks->{{{1, 
       FormBox["5", TraditionalForm]}, {2, 
       FormBox["10", TraditionalForm]}, {3, 
       FormBox["15", TraditionalForm]}, {4, 
       FormBox["20", TraditionalForm]}, {5, 
       FormBox["25", TraditionalForm]}, {6, 
       FormBox["30", TraditionalForm]}, {7, 
       FormBox["35", TraditionalForm]}, {8, 
       FormBox["40", TraditionalForm]}, {9, 
       FormBox["45", TraditionalForm]}, {10, 
       FormBox["50", TraditionalForm]}}, Automatic}],
  InterpretTemplate[Legended[
    Graphics[{{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           Rational[7, 360]], 
          RGBColor[0.9, 0.36, 0.054], 
          CapForm["Butt"], 
          AbsoluteThickness[1.6], 
          Dashing[{Small, Small}]], 
         Line[{{5., 1.}, {10., 1.0204122002150215`}, {15., 
          1.0782289840436954`}, {20., 1.1911796077506784`}, {25., 
          1.282777937511916}, {30., 1.394500582368709}, {35., 
          1.4834996398900548`}, {40., 1.5968431236749425`}, {45., 
          1.653781048313147}, {50., 1.6601640796025012`}}]}, {
         Hue[0.9060679774997897, 0.6, 0.6], 
         Directive[
          PointSize[
           Rational[7, 360]], 
          RGBColor[0.365248, 0.427802, 0.758297], 
          CapForm["Butt"], 
          AbsoluteThickness[1.6], 
          Dashing[{Small, Small}]], 
         Line[{{5., 1.3565062438669027`}, {10., 1.264462487604371}, {15., 
          1.2992825630228775`}, {20., 1.2681750143711104`}, {25., 
          1.2776527918451133`}, {30., 1.2232963190900108`}, {35., 
          1.2521761768789814`}, {40., 1.2565043526531483`}, {45., 
          1.19912746569413}, {50., 1.2570957853181892`}}]}}, {{
         Directive[
          PointSize[
           Rational[7, 360]], 
          RGBColor[0.9, 0.36, 0.054], 
          CapForm["Butt"], 
          AbsoluteThickness[1.6], 
          Dashing[{Small, Small}]], 
         GeometricTransformation[
          Inset[
           Style[
            Graphics[{
              EdgeForm[], 
              Disk[{0, 0}]}], 
            GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.9, 0.36, 0.054], 
                CapForm["Butt"], 
                AbsoluteThickness[1.6], 
                Dashing[{Small, Small}]]}], {0., 0.}, Automatic, 
           Offset[10]], {{{5., 1.}}, {{10., 1.0204122002150215`}}, {{15., 
          1.0782289840436954`}}, {{20., 1.1911796077506784`}}, {{25., 
          1.282777937511916}}, {{30., 1.394500582368709}}, {{35., 
          1.4834996398900548`}}, {{40., 1.5968431236749425`}}, {{45., 
          1.653781048313147}}, {{50., 1.6601640796025012`}}}]}, {
         Directive[
          PointSize[
           Rational[7, 360]], 
          RGBColor[0.365248, 0.427802, 0.758297], 
          CapForm["Butt"], 
          AbsoluteThickness[1.6], 
          Dashing[{Small, Small}]], 
         GeometricTransformation[
          Inset[
           Style[
            Graphics[{
              EdgeForm[], 
              Polygon[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}], 
            GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.365248, 0.427802, 0.758297], 
                CapForm["Butt"], 
                AbsoluteThickness[1.6], 
                Dashing[{Small, Small}]]}], {0., 0.}, Automatic, 
           Offset[10]], {{{5., 1.3565062438669027`}}, {{10., 
          1.264462487604371}}, {{15., 1.2992825630228775`}}, {{20., 
          1.2681750143711104`}}, {{25., 1.2776527918451133`}}, {{30., 
          1.2232963190900108`}}, {{35., 1.2521761768789814`}}, {{40., 
          1.2565043526531483`}}, {{45., 1.19912746569413}}, {{50., 
          1.2570957853181892`}}}]}}}, {{}, {}}}, {
     DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
      GoldenRatio^(-1), Axes -> {False, False}, AxesLabel -> {None, None}, 
      AxesOrigin -> {0, 0.9633242177998633}, DisplayFunction :> Identity, 
      Frame -> {{True, True}, {True, True}}, 
      FrameLabel -> {{"Approx Ratio", None}, {"# patients (n)", None}}, 
      FrameStyle -> Automatic, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {{0}, {0}}, GridLinesStyle -> Directive[
        GrayLevel[0.5, 0.4]], 
      LabelStyle -> {
       FontSize -> 18, FontColor -> GrayLevel[0], FontFamily -> 
        "CMU Sans Serif"}, 
      Method -> {
       "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& )}}, 
      PlotRange -> {{0, 50.}, {0.9633242177998633, 1.6601640796025012`}}, 
      PlotRangeClipping -> True, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}}, 
      Ticks -> {{{1, 5}, {2, 10}, {3, 15}, {4, 20}, {5, 25}, {6, 30}, {7, 
        35}, {8, 40}, {9, 45}, {10, 50}}, Automatic}}], 
    Placed[
     Unevaluated[
      LineLegend[{
        Directive[
         PointSize[
          Rational[7, 360]], 
         RGBColor[0.9, 0.36, 0.054], 
         CapForm["Butt"], 
         AbsoluteThickness[1.6], 
         Dashing[{Small, Small}]], 
        Directive[
         PointSize[
          Rational[7, 360]], 
         RGBColor[0.365248, 0.427802, 0.758297], 
         CapForm["Butt"], 
         AbsoluteThickness[1.6], 
         Dashing[{Small, Small}]]}, {"Random", "Greedy"}, LegendMarkers -> {{
          Graphics[{
            EdgeForm[], 
            Disk[{0, 0}]}], 
          Offset[10]}, {
          Graphics[{
            EdgeForm[], 
            Polygon[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}], 
          Offset[10]}}, Joined -> {True, True}, 
       LabelStyle -> {
        FontSize -> 18, FontColor -> GrayLevel[0], FontFamily -> 
         "CMU Sans Serif"}, LegendLayout -> "Column"]], {0.25, 0.8}, 
     Identity]]& ],
  AutoDelete->True,
  Editable->True,
  SelectWithContents->False,
  Selectable->True]], "Output",
 CellChangeTimes->{{3.858699312325802*^9, 3.8586993171645737`*^9}, 
   3.8586995543247023`*^9, {3.85869962895452*^9, 3.858699669125596*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"d52b701d-7ea5-4c42-95b5-5f76b412f06a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.85869927441691*^9, 
  3.858699274421154*^9}},ExpressionUUID->"47bfabd4-6bfc-4783-ba6d-\
334e606fa847"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8587016823599377`*^9, 
  3.858701682365838*^9}},ExpressionUUID->"a8a82dc1-0a36-4fb9-9ae1-\
bdf33fe03edd"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Range", "[", "30", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"o", "=", 
     RowBox[{"Range", "[", "20", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"PoissonDistribution", "[", "15", "]"}], ",", "30"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pZ", "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}], ",", "30"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"oZ", "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}], ",", "20"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dis", "=", 
     RowBox[{"5", 
      RowBox[{"Ramp", "[", 
       RowBox[{
        RowBox[{"DistanceMatrix", "[", 
         RowBox[{"pZ", ",", "oZ"}], "]"}], "-", "5"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"randomSim", " ", "=", " ", 
     RowBox[{"RandomSim", "[", 
      RowBox[{
      "p", ",", " ", "o", ",", " ", "dis", ",", " ", "w", ",", " ", "30", ",",
        " ", "20"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.858680471210555*^9, 3.8586804748723717`*^9}, {
  3.858684746220539*^9, 3.858684796829583*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"bf0ac399-7d82-4dd8-8be6-81cf12a072e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"randomSim", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "50", ",", "\"\<Probability\>\"", 
   ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Life Expectancy per Patient\>\"", ",", "\"\<Probability\>\""}], 
     "}"}]}], ",", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontSize", "->", "18"}], ",", 
      RowBox[{"FontColor", "->", "Black"}], ",", 
      RowBox[{"FontFamily", "->", "\"\<CMU Sans Serif\>\""}]}], "}"}]}], ",", 
   
   RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "4"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8586799747211523`*^9, {3.8586848010761414`*^9, 3.858684803774909*^9}, {
   3.858684855840742*^9, 3.858684877981698*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"0d281b3e-0c42-4ff3-80a9-abadabe2f68e"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.92, 0.488, 0.2432], EdgeForm[{Opacity[0.182], Thickness[
    Small]}], {}, 
    {RGBColor[0.92, 0.488, 0.2432], EdgeForm[{Opacity[0.182], Thickness[
     Small]}], RectangleBox[{21.5, 0}, {22., 8.*^-6},
      RoundingRadius->0], RectangleBox[{22., 0}, {22.5, 0.000176},
      RoundingRadius->0], RectangleBox[{22.5, 0}, {23., 0.000248},
      RoundingRadius->0], RectangleBox[{23., 0}, {23.5, 0.000504},
      RoundingRadius->0], RectangleBox[{23.5, 0}, {24., 0.000656},
      RoundingRadius->0], RectangleBox[{24., 0}, {24.5, 0.001264},
      RoundingRadius->0], RectangleBox[{24.5, 0}, {25., 0.001848},
      RoundingRadius->0], RectangleBox[{25., 0}, {25.5, 0.0032},
      RoundingRadius->0], RectangleBox[{25.5, 0}, {26., 0.004176},
      RoundingRadius->0], RectangleBox[{26., 0}, {26.5, 0.00528},
      RoundingRadius->0], RectangleBox[{26.5, 0}, {27., 0.006808},
      RoundingRadius->0], RectangleBox[{27., 0}, {27.5, 0.009048},
      RoundingRadius->0], RectangleBox[{27.5, 0}, {28., 0.010296},
      RoundingRadius->0], RectangleBox[{28., 0}, {28.5, 0.012712},
      RoundingRadius->0], RectangleBox[{28.5, 0}, {29., 0.014616},
      RoundingRadius->0], RectangleBox[{29., 0}, {29.5, 0.0174},
      RoundingRadius->0], RectangleBox[{29.5, 0}, {30., 0.020792},
      RoundingRadius->0], RectangleBox[{30., 0}, {30.5, 0.023432},
      RoundingRadius->0], RectangleBox[{30.5, 0}, {31., 0.02556},
      RoundingRadius->0], RectangleBox[{31., 0}, {31.5, 0.02792},
      RoundingRadius->0], RectangleBox[{31.5, 0}, {32., 0.030376},
      RoundingRadius->0], RectangleBox[{32., 0}, {32.5, 0.032544},
      RoundingRadius->0], RectangleBox[{32.5, 0}, {33., 0.034656},
      RoundingRadius->0], RectangleBox[{33., 0}, {33.5, 0.036752},
      RoundingRadius->0], RectangleBox[{33.5, 0}, {34., 0.038208},
      RoundingRadius->0], RectangleBox[{34., 0}, {34.5, 0.038304},
      RoundingRadius->0], RectangleBox[{34.5, 0}, {35., 0.039304},
      RoundingRadius->0], RectangleBox[{35., 0}, {35.5, 0.040624},
      RoundingRadius->0], RectangleBox[{35.5, 0}, {36., 0.040336},
      RoundingRadius->0], RectangleBox[{36., 0}, {36.5, 0.038896},
      RoundingRadius->0], RectangleBox[{36.5, 0}, {37., 0.039376},
      RoundingRadius->0], RectangleBox[{37., 0}, {37.5, 0.037768},
      RoundingRadius->0], RectangleBox[{37.5, 0}, {38., 0.037176},
      RoundingRadius->0], RectangleBox[{38., 0}, {38.5, 0.034328},
      RoundingRadius->0], RectangleBox[{38.5, 0}, {39., 0.032648},
      RoundingRadius->0], RectangleBox[{39., 0}, {39.5, 0.030008},
      RoundingRadius->0], RectangleBox[{39.5, 0}, {40., 0.029144},
      RoundingRadius->0], RectangleBox[{40., 0}, {40.5, 0.02648},
      RoundingRadius->0], RectangleBox[{40.5, 0}, {41., 0.02408},
      RoundingRadius->0], RectangleBox[{41., 0}, {41.5, 0.021912},
      RoundingRadius->0], RectangleBox[{41.5, 0}, {42., 0.019176},
      RoundingRadius->0], RectangleBox[{42., 0}, {42.5, 0.017232},
      RoundingRadius->0], RectangleBox[{42.5, 0}, {43., 0.01484},
      RoundingRadius->0], RectangleBox[{43., 0}, {43.5, 0.0132},
      RoundingRadius->0], RectangleBox[{43.5, 0}, {44., 0.01128},
      RoundingRadius->0], RectangleBox[{44., 0}, {44.5, 0.009864},
      RoundingRadius->0], RectangleBox[{44.5, 0}, {45., 0.008448},
      RoundingRadius->0], RectangleBox[{45., 0}, {45.5, 0.007352},
      RoundingRadius->0], RectangleBox[{45.5, 0}, {46., 0.005768},
      RoundingRadius->0], RectangleBox[{46., 0}, {46.5, 0.004696},
      RoundingRadius->0], RectangleBox[{46.5, 0}, {47., 0.0044},
      RoundingRadius->0], RectangleBox[{47., 0}, {47.5, 0.003152},
      RoundingRadius->0], RectangleBox[{47.5, 0}, {48., 0.00264},
      RoundingRadius->0], RectangleBox[{48., 0}, {48.5, 0.002192},
      RoundingRadius->0], RectangleBox[{48.5, 0}, {49., 0.001664},
      RoundingRadius->0], RectangleBox[{49., 0}, {49.5, 0.001208},
      RoundingRadius->0], RectangleBox[{49.5, 0}, {50., 0.001048},
      RoundingRadius->0], RectangleBox[{50., 0}, {50.5, 0.000784},
      RoundingRadius->0], RectangleBox[{50.5, 0}, {51., 0.00064},
      RoundingRadius->0], RectangleBox[{51., 0}, {51.5, 0.0004},
      RoundingRadius->0], RectangleBox[{51.5, 0}, {52., 0.000336},
      RoundingRadius->0], RectangleBox[{52., 0}, {52.5, 0.000248},
      RoundingRadius->0], RectangleBox[{52.5, 0}, {53., 0.000112},
      RoundingRadius->0], RectangleBox[{53., 0}, {53.5, 0.000272},
      RoundingRadius->0], RectangleBox[{53.5, 0}, {54., 0.000064},
      RoundingRadius->0], RectangleBox[{54., 0}, {54.5, 0.000048},
      RoundingRadius->0], RectangleBox[{54.5, 0}, {55., 0.000024},
      RoundingRadius->0], RectangleBox[{55., 0}, {55.5, 0.000024},
      RoundingRadius->0], RectangleBox[{56.5, 0}, {57., 0.000016},
      RoundingRadius->0], RectangleBox[{57., 0}, {57.5, 8.*^-6},
      RoundingRadius->
       0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
  AspectRatio->NCache[
    Rational[1, 4], 0.25],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{20.78, 0},
  Frame->True,
  FrameLabel->{{
     FormBox["\"Probability\"", TraditionalForm], None}, {
     FormBox["\"Life Expectancy per Patient\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{{0}, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{516.19921875, Automatic},
  LabelStyle->{
   FontSize -> 18, FontColor -> GrayLevel[0], FontFamily -> "CMU Sans Serif"},
  
  PlotRange->{{21.5, 57.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {None, 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.858684804811583*^9, 3.8586848415418377`*^9, {3.85868489271402*^9, 
   3.858684897503233*^9}},
 CellLabel->"Out[43]=",ExpressionUUID->"41e9f577-b460-4ca0-a4d8-f7d5420670a4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"optimalSim", " ", "=", " ", 
  RowBox[{"(*", 
   RowBox[{"OptimalSim", "[", 
    RowBox[{
    "p", ",", " ", "o", ",", " ", "dis", ",", " ", "w", ",", " ", "30", ",", 
     " ", "20"}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8586849489490232`*^9, 3.858684961374073*^9}, 
   3.858685009035397*^9},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[1]:=",ExpressionUUID->"f91ad2d3-b747-4f7c-a521-25b77d1941d1"]
}, Open  ]]
},
WindowSize->{1224, 778},
WindowMargins->{{Automatic, 5}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"55d41253-5cd8-47a6-96f7-94e63032e9cf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 227, 4, 30, "Input",ExpressionUUID->"bfcb8005-22c5-4fee-b8aa-c6ae2a390fb3"],
Cell[788, 26, 326, 8, 30, "Input",ExpressionUUID->"e3588c0d-eee4-4f2e-af49-9f3a079da52f"],
Cell[CellGroupData[{
Cell[1139, 38, 160, 3, 54, "Subsection",ExpressionUUID->"65ba6b55-0cda-40b5-9173-bfd633501c4f"],
Cell[1302, 43, 567, 9, 30, "Input",ExpressionUUID->"944a701a-0fd3-4031-91ff-6adb1cb85276"],
Cell[1872, 54, 1243, 36, 94, "Input",ExpressionUUID->"575ec06b-a8f5-4e82-bb4f-5ee262caec37"],
Cell[3118, 92, 4863, 118, 220, "Input",ExpressionUUID->"02b1a2c8-5fc5-450c-a7a2-9317c384585a"],
Cell[7984, 212, 24581, 601, 1466, "Input",ExpressionUUID->"15b01b56-b5d5-4c93-8a66-aa3e1040cc0f"],
Cell[32568, 815, 371, 6, 30, "Input",ExpressionUUID->"9583f919-2f58-40d5-a649-096a77c66b72"],
Cell[CellGroupData[{
Cell[32964, 825, 457, 8, 30, "Input",ExpressionUUID->"34e01d77-a8ae-4b18-83c0-b4ca1b80292d"],
Cell[33424, 835, 703, 12, 34, "Output",ExpressionUUID->"fbac354b-b1ea-4188-9e44-caf57e979faa"]
}, Open  ]],
Cell[34142, 850, 178, 4, 30, "Input",ExpressionUUID->"5298b86f-1365-476f-a70c-aa7e91d10fe9"],
Cell[CellGroupData[{
Cell[34345, 858, 1210, 31, 30, "Input",ExpressionUUID->"245dd2ea-c2aa-4dab-a94f-90939702aa79"],
Cell[35558, 891, 1326, 29, 56, "Output",ExpressionUUID->"e576a9b5-602d-463a-b2fd-243ac687683d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36921, 925, 2984, 72, 94, "Input",ExpressionUUID->"7ce1c9c3-1195-4f14-85fb-327189b3df86"],
Cell[39908, 999, 19195, 446, 261, "Output",ExpressionUUID->"d52b701d-7ea5-4c42-95b5-5f76b412f06a"]
}, Open  ]],
Cell[59118, 1448, 151, 3, 30, InheritFromParent,ExpressionUUID->"47bfabd4-6bfc-4783-ba6d-334e606fa847"],
Cell[59272, 1453, 154, 3, 30, InheritFromParent,ExpressionUUID->"a8a82dc1-0a36-4fb9-9ae1-bdf33fe03edd"],
Cell[59429, 1458, 1596, 45, 178, "Input",ExpressionUUID->"bf0ac399-7d82-4dd8-8be6-81cf12a072e4"],
Cell[CellGroupData[{
Cell[61050, 1507, 1003, 25, 52, "Input",ExpressionUUID->"0d281b3e-0c42-4ff3-80a9-abadabe2f68e"],
Cell[62056, 1534, 6155, 107, 192, "Output",ExpressionUUID->"41e9f577-b460-4ca0-a4d8-f7d5420670a4"]
}, Open  ]],
Cell[68226, 1644, 438, 10, 30, "Input",ExpressionUUID->"f91ad2d3-b747-4f7c-a521-25b77d1941d1"]
}, Open  ]]
}
]
*)

