(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33531,        835]
NotebookOptionsPosition[     31533,        797]
NotebookOutlinePosition[     31928,        813]
CellTagsIndexPosition[     31885,        810]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"m", ",", "n"}], "]"}]], "Input",
 CellChangeTimes->{{3.8584472216599197`*^9, 3.858447223393093*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"bfcb8005-22c5-4fee-b8aa-c6ae2a390fb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n"}], "}"}], "\[Element]", "PositiveIntegers"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8584397461885767`*^9, 3.858439761233712*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e3588c0d-eee4-4f2e-af49-9f3a079da52f"],

Cell[CellGroupData[{

Cell["Experiment", "Subsection",
 CellChangeTimes->{{3.858447240945939*^9, 
  3.8584472453114223`*^9}},ExpressionUUID->"65ba6b55-0cda-40b5-9173-\
bfd633501c4f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8584440147382317`*^9, 3.858444163610165*^9}, {
   3.858444291919211*^9, 3.858444292208202*^9}, {3.858445221075*^9, 
   3.858445241778583*^9}, {3.858596533821495*^9, 3.85859653498839*^9}, {
   3.85867755893909*^9, 3.8586775640421124`*^9}, {3.858677608619892*^9, 
   3.858677640218102*^9}, {3.85867824281966*^9, 3.858678245261001*^9}, {
   3.858678965454884*^9, 3.8586789807554827`*^9}, {3.858679166972246*^9, 
   3.858679177431501*^9}, 
   3.858679438301207*^9},ExpressionUUID->"944a701a-0fd3-4031-91ff-\
6adb1cb85276"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RandomSim", "[", 
    RowBox[{
    "p0_", ",", " ", "o0_", ",", " ", "dis0_", ",", " ", "w0_", ",", " ", 
     "m0_", ",", " ", "n0_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "=", "p0"}], ",", " ", 
       RowBox[{"w", "=", "w0"}], ",", " ", 
       RowBox[{"m", "=", "m0"}], ",", " ", 
       RowBox[{"n", "=", "n0"}], ",", " ", 
       RowBox[{"o", "=", "o0"}], ",", " ", 
       RowBox[{"dis", "=", "dis0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"p_", ",", "o_"}], "}"}], "]"}], ":=", 
       RowBox[{"dis", "[", 
        RowBox[{"[", 
         RowBox[{"p", ",", "o"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"Life", "[", "alloc_", "]"}], ":=", 
       RowBox[{"Total", "[", 
        RowBox[{"f", "/@", "alloc"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Wait", "[", 
        RowBox[{"p_", ",", "alloc_"}], "]"}], ":=", 
       RowBox[{"Total", "[", 
        RowBox[{"w", "[", 
         RowBox[{"[", 
          RowBox[{"Complement", "[", 
           RowBox[{"p", ",", 
            RowBox[{"alloc", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Goal", "[", 
        RowBox[{"p_", ",", "alloc_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Wait", "[", 
         RowBox[{"p", ",", "alloc"}], "]"}], "+", 
        RowBox[{"Life", "[", "alloc", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormlizedGoal", "[", 
        RowBox[{"p_", ",", "alloc_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Goal", "[", 
         RowBox[{"p", ",", "alloc"}], "]"}], "-", 
        RowBox[{"Total", "[", 
         RowBox[{"w", "[", 
          RowBox[{"[", "p", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RandomAlloc", "[", 
        RowBox[{"p_", ",", "o_"}], "]"}], ":=", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{"f", "[", "#1", "]"}], ">", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ",", "#1", 
            ",", "Nothing"}], "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"RandomSample", "[", "p", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"Min", "[", 
                RowBox[{"m", ",", "n"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"RandomSample", "[", "o", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"Min", "[", 
                RowBox[{"m", ",", "n"}], "]"}]}], "]"}], "]"}]}], "}"}], 
          "\[Transpose]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SampleGoal", "[", 
        RowBox[{"p", ",", "o"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Goal", "[", 
            RowBox[{"p", ",", "#"}], "]"}], ",", " ", "#"}], "}"}], "&"}], 
        "@", 
        RowBox[{"RandomAlloc", "[", 
         RowBox[{"p", ",", "o"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"smps", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", "n"}], ",", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], " ", "@", 
          RowBox[{"SampleGoal", "[", 
           RowBox[{"p", ",", "o"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "+", "n"}], ")"}], "^", "2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"scores", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "smps"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allocations", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", "smps"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"scores", ",", " ", "allocations"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.858444213414798*^9, 3.8584442237929783`*^9}, {
   3.8584442994010077`*^9, 3.858444300050644*^9}, {3.858445041323862*^9, 
   3.85844504152321*^9}, {3.8584451135192223`*^9, 3.8584451513702087`*^9}, {
   3.858445681515019*^9, 3.8584456953397207`*^9}, {3.8584457442158623`*^9, 
   3.8584457481988907`*^9}, {3.85859682302219*^9, 3.858596841543169*^9}, {
   3.858596880327045*^9, 3.8585968825830803`*^9}, {3.858679033626916*^9, 
   3.858679034179351*^9}, 3.858679113250317*^9, {3.858679226410907*^9, 
   3.858679338732336*^9}, {3.858679778500105*^9, 3.858679827290266*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"02b1a2c8-5fc5-450c-a7a2-9317c384585a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptimalSim", "[", 
     RowBox[{
     "p0_", ",", " ", "o0_", ",", " ", "dis0_", ",", " ", "w0_", ",", " ", 
      "m0_", ",", " ", "n0_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", "p0"}], ",", " ", 
        RowBox[{"w", "=", "w0"}], ",", " ", 
        RowBox[{"m", "=", "m0"}], ",", " ", 
        RowBox[{"n", "=", "n0"}], ",", " ", 
        RowBox[{"o", "=", "o0"}], ",", " ", 
        RowBox[{"dis", "=", "dis0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"m", ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"i_", ",", "j_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<x\>\"", "<>", 
          RowBox[{"ToString", "@", "i"}], "<>", "\"\<d\>\"", " ", "<>", 
          RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<d\>\"", " ", "<>",
           " ", 
          RowBox[{"ToString", "@", "t"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"waitConstr", "[", 
         RowBox[{"w_", ",", " ", "i_"}], "]"}], " ", ":=", "  ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<x\>\"", "<>", 
              RowBox[{"ToString", "@", "i"}], "<>", "\"\<d\>\"", " ", "<>", 
              RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<d\>\"", 
              " ", "<>", " ", 
              RowBox[{"ToString", "@", "t"}]}], "]"}], " ", "==", " ", "0"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "m"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", 
             RowBox[{"w", "+", "1"}], ",", " ", "T"}], "}"}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EvaluateSolution", "[", "alloc_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dis", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], " ", "&"}], 
             " ", "/@", "alloc"}], "]"}], " ", "+", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", 
               RowBox[{"Complement", "[", 
                RowBox[{"p", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", 
                  "alloc"}]}], "]"}], "]"}], "]"}], " ", "//", " ", "Total"}],
             ")"}]}], ")"}], "/", "n"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"obj1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"dis", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "*", 
             RowBox[{"var", "[", 
              RowBox[{"i", ",", "j", ",", "t"}], "]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "  ", "n"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", "  ", "m"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "//", " ", 
          "Flatten"}], " ", "//", " ", "Total"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"obj2", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"w", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "*", " ", 
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", " ", "m"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "//", 
                 " ", "Flatten"}], " ", "//", " ", "Total"}], " ", ")"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], "  ", "//", " ", 
         "Total"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"obj", " ", "=", " ", 
        RowBox[{"obj1", " ", "+", " ", "obj2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"constr", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", "m"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "]"}], 
             " ", "//", " ", "Total"}], ")"}], " ", "<=", " ", "1"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"constr2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], "]"}], " ", "//",
              "Total"}], ")"}], " ", "<=", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "m"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"constr3", " ", "=", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"i", ",", "j", ",", "t"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", "m"}], "}"}]}], "]"}], "]"}], " ", "//",
              "Total"}], ")"}], "<=", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"constr4", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"var", "[", 
             RowBox[{"i", ",", "j", ",", "t"}], "]"}], " ", ">=", " ", "0"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "m"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], " ", "//", " ", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"constr5", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"waitConstr", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"w", ",", " ", "p"}], "}"}], "]"}]}], " ", "//", " ", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"LinearOptimization", "[", 
         RowBox[{
          RowBox[{"obj1", "+", "obj2"}], ",", " ", 
          RowBox[{
          "constr", "~", "Join", "~", "constr2", "~", "Join", "~", "constr3", 
           "~", "Join", "~", "constr4", "~", "Join", "~", "constr5"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"var", "[", 
               RowBox[{"i", ",", "j", ",", "t"}], "]"}], "\[Element]", " ", 
              "Integers"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", "m"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "T"}], "}"}]}], "]"}], "//", 
           "Flatten"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SplitRes", "[", "s_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", "s"}], "//", " ", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", " ", "\"\<x\>\""}], "]"}], "&"}]}], " ", "//",
            " ", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", " ", "\"\<d\>\""}], "]"}], "&"}]}], " ", "//", 
          "ToExpression"}], "//", " ", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExtractAllocation", "[", "res_", "]"}], ":=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SplitRes", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
           " ", 
           RowBox[{"Select", "[", 
            RowBox[{"res", ",", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "1"}], "&"}],
               ")"}]}], "]"}]}], ",", " ", "Last"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"alloc", " ", "=", " ", 
        RowBox[{"ExtractAllocation", "[", "res", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EvaluateSolution", "[", "alloc", "]"}], ",", " ", "alloc"}],
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sim", "[", 
     RowBox[{"n0_", ",", " ", "m0_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", "n0"}], ",", " ", 
        RowBox[{"m", "=", "m0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"o", "=", 
        RowBox[{"Range", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"PoissonDistribution", "[", "15", "]"}], ",", "n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pZ", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", "10"}], "]"}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"oZ", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", "10"}], "]"}], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dis", "=", 
        RowBox[{"5", 
         RowBox[{"Ramp", "[", 
          RowBox[{
           RowBox[{"DistanceMatrix", "[", 
            RowBox[{"pZ", ",", "oZ"}], "]"}], "-", "5"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"randomScores", " ", "=", " ", 
        RowBox[{
         RowBox[{"RandomSim", "[", 
          RowBox[{
          "p", ",", " ", "o", ",", " ", "dis", ",", " ", "w", ",", " ", "m", 
           ",", " ", "n"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"optimalScore", " ", "=", " ", 
        RowBox[{
         RowBox[{"OptimalSim", "[", 
          RowBox[{
          "p", ",", " ", "o", ",", " ", "dis", ",", " ", "w", ",", " ", "m", 
           ",", " ", "n"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Max", "[", "randomScores", "]"}], ",", " ", 
         "optimalScore"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.85859495011421*^9, 3.858595040146738*^9}, {
  3.858595080843152*^9, 3.858595211766172*^9}, {3.8585954178322783`*^9, 
  3.858595498871726*^9}, {3.85859553371247*^9, 3.8585955461835203`*^9}, {
  3.858595624218296*^9, 3.858595636749614*^9}, {3.858595668987262*^9, 
  3.858595678036394*^9}, {3.858596433193225*^9, 3.858596450191517*^9}, {
  3.858678161793344*^9, 3.85867817395884*^9}, {3.858678210534581*^9, 
  3.8586782114864264`*^9}, {3.85867859540471*^9, 3.858678616928318*^9}, {
  3.8586790630386343`*^9, 3.8586790633407383`*^9}, {3.858679187483774*^9, 
  3.858679189243516*^9}, {3.858679385762171*^9, 3.858679618712492*^9}, {
  3.858679652723298*^9, 3.858679653104444*^9}, {3.858679857962049*^9, 
  3.858679899805685*^9}, {3.858680191634077*^9, 3.858680192119433*^9}, {
  3.858680282188075*^9, 3.8586802853003483`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"15b01b56-b5d5-4c93-8a66-aa3e1040cc0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sim", "[", 
  RowBox[{"5", ",", " ", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.85868028855872*^9, 3.858680322156495*^9}, {
  3.858680430176867*^9, 3.85868043400014*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"2cf6c92a-5e6a-46be-bd85-0aabbe25cd83"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"41.57970768681144`", ",", "41.57970768681143`"}], "}"}]], "Output",\

 CellChangeTimes->{{3.858680289084037*^9, 3.8586803225297403`*^9}, 
   3.858683642787027*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"9a2b383d-3f13-4ff4-b44c-b58d9da53153"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.858678417642577*^9, 3.858678472686719*^9}, {
   3.858678517231472*^9, 3.858678519744618*^9}, {3.858678553599695*^9, 
   3.858678577693468*^9}, {3.858678833145101*^9, 3.858678869366407*^9}, 
   3.858679060583838*^9, {3.858680177410387*^9, 
   3.858680188876236*^9}},ExpressionUUID->"9583f919-2f58-40d5-a649-\
096a77c66b72"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.858596495035491*^9, 3.8585964975244017`*^9}, {
   3.8585965794832077`*^9, 3.858596581722124*^9}, {3.8585966163796997`*^9, 
   3.858596700877342*^9}, {3.858597002248343*^9, 3.858597007034544*^9}, {
   3.858677757439744*^9, 3.8586777762914886`*^9}, {3.858677914709444*^9, 
   3.858677916266226*^9}, {3.858678525099782*^9, 3.85867852972921*^9}, {
   3.858678940051097*^9, 3.858678940517188*^9}, {3.858679140823636*^9, 
   3.858679150986807*^9}, {3.858679589068182*^9, 3.858679589333478*^9}, {
   3.85867962302318*^9, 3.858679687170615*^9}, {3.858679903111302*^9, 
   3.8586799172502117`*^9}, {3.858680053667721*^9, 3.85868018644613*^9}, {
   3.858680241891952*^9, 3.858680255047865*^9}, {3.858680325677915*^9, 
   3.858680351462057*^9}, 
   3.858683650745536*^9},ExpressionUUID->"c1aab33d-79f2-4d4d-b9c1-\
255a2007c81b"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.858680476237008*^9, 3.858680476240081*^9}, 
   3.858683653822701*^9},ExpressionUUID->"34e01d77-a8ae-4b18-83c0-\
b4ca1b80292d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ratios", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "/", " ", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "@", 
        RowBox[{"Sim", "[", 
         RowBox[{"n", ",", "n"}], "]"}]}], ",", " ", "2"}], "]"}], "//", 
     "Mean"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "5", ",", " ", "60", ",", " ", "5"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8586804799836683`*^9, 3.858680522158287*^9}, {
  3.858680611796393*^9, 3.858680618142186*^9}, {3.8586821114020863`*^9, 
  3.858682113027054*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"245dd2ea-c2aa-4dab-a94f-90939702aa79"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.0532869117546753`", ",", "1.0882530078663688`", ",", 
   "1.1976339491716237`", ",", "1.3450013807772159`", ",", 
   "1.3772410684077718`", ",", "1.5417992643763352`", ",", 
   "1.5862934880169974`", ",", "1.6101879243922492`", ",", 
   "1.6894979302292936`", ",", "1.6929595375459008`", ",", 
   "1.7137612367702313`"}], "}"}]], "Output",
 CellChangeTimes->{3.858680499513157*^9, 3.858680569359521*^9, 
  3.858680769540333*^9, 3.858682348911467*^9, 3.858683888224504*^9, 
  3.858684335752742*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"e943b341-555e-4285-83c3-e71880476e28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"5", ",", " ", "60", ",", " ", "5"}], "]"}], ",", " ", 
       "ratios"}], "}"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<# patients (n)\>\"", ",", "\"\<Approx Ratio\>\""}], 
      "}"}]}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "->", "18"}], ",", 
       RowBox[{"FontColor", "->", "Black"}], ",", 
       RowBox[{"FontFamily", "->", "\"\<CMU Sans Serif\>\""}]}], "}"}]}], ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotMarkers", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", " ", "10"}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.858681795999518*^9, 3.858681966467224*^9}, {
   3.858682005122922*^9, 3.858682093473817*^9}, {3.858682429435648*^9, 
   3.858682450292967*^9}, {3.8586825016590137`*^9, 3.858682504575211*^9}, {
   3.8586829350445127`*^9, 3.8586829404061327`*^9}, 3.858683017900858*^9, {
   3.858683481699609*^9, 3.858683481973402*^9}, {3.8586845624514112`*^9, 
   3.858684571802701*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"7ce1c9c3-1195-4f14-85fb-327189b3df86"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.9, 0.36, 0.054], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
      Dashing[{Small, Small}], CapForm["Butt"], 
      LineBox[{{5., 1.}, {10., 1.0532869117546753`}, {15., 
       1.0882530078663688`}, {20., 1.1976339491716237`}, {25., 
       1.3450013807772159`}, {30., 1.3772410684077718`}, {35., 
       1.5417992643763352`}, {40., 1.5862934880169974`}, {45., 
       1.6101879243922492`}, {50., 1.6894979302292936`}, {55., 
       1.6929595375459008`}, {60., 1.7137612367702313`}}]}}, 
    {RGBColor[0.9, 0.36, 0.054], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
     Dashing[{Small, Small}], CapForm["Butt"], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]}],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.9, 0.36, 0.054], 
           CapForm["Butt"], 
           AbsoluteThickness[1.6], 
           Dashing[{Small, Small}]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{5., 1.}}, {{
      10., 1.0532869117546753`}}, {{15., 1.0882530078663688`}}, {{20., 
      1.1976339491716237`}}, {{25., 1.3450013807772159`}}, {{30., 
      1.3772410684077718`}}, {{35., 1.5417992643763352`}}, {{40., 
      1.5862934880169974`}}, {{45., 1.6101879243922492`}}, {{50., 
      1.6894979302292936`}}, {{55., 1.6929595375459008`}}, {{60., 
      1.7137612367702313`}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{3.854166666666675, 0.9603465979572117},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Approx Ratio\"", TraditionalForm], None}, {
     FormBox["\"# patients (n)\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{{0}, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  LabelStyle->{
   FontSize -> 18, FontColor -> GrayLevel[0], FontFamily -> "CMU Sans Serif"},
  
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{3.854166666666675, 60.}, {0.9603465979572117, 
   1.7137612367702313`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.85868205320476*^9, {3.858682085797127*^9, 3.858682094096895*^9}, {
   3.858682434524549*^9, 3.858682450722026*^9}, 3.858682506607963*^9, {
   3.858682843610128*^9, 3.858682844849435*^9}, 3.8586829452748404`*^9, {
   3.8586834615059566`*^9, 3.858683462760639*^9}, 3.8586836295599403`*^9, {
   3.8586840692855186`*^9, 3.85868409455683*^9}, 3.8586845726853867`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"84132dce-0393-4d92-8050-0c444c562821"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.858680471210555*^9, 
  3.8586804748723717`*^9}},ExpressionUUID->"bf0ac399-7d82-4dd8-8be6-\
81cf12a072e4"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"scores", ",", "50", ",", "\"\<Probability\>\"", ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Years of Life Added Per Patient\>\"", ",", "\"\<Probability\>\""}], 
     "}"}]}], ",", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontSize", "->", "18"}], ",", 
      RowBox[{"FontColor", "->", "Black"}], ",", 
      RowBox[{"FontFamily", "->", "\"\<CMU Sans Serif\>\""}]}], "}"}]}], ",", 
   
   RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "4"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8586799747211523`*^9},ExpressionUUID->"0d281b3e-0c42-4ff3-80a9-\
abadabe2f68e"]
}, Open  ]]
},
WindowSize->{1224, 847},
WindowMargins->{{Automatic, 5}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"55d41253-5cd8-47a6-96f7-94e63032e9cf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 227, 4, 30, "Input",ExpressionUUID->"bfcb8005-22c5-4fee-b8aa-c6ae2a390fb3"],
Cell[788, 26, 326, 8, 30, "Input",ExpressionUUID->"e3588c0d-eee4-4f2e-af49-9f3a079da52f"],
Cell[CellGroupData[{
Cell[1139, 38, 160, 3, 54, "Subsection",ExpressionUUID->"65ba6b55-0cda-40b5-9173-bfd633501c4f"],
Cell[1302, 43, 567, 9, 30, "Input",ExpressionUUID->"944a701a-0fd3-4031-91ff-6adb1cb85276"],
Cell[1872, 54, 5778, 151, 325, "Input",ExpressionUUID->"02b1a2c8-5fc5-450c-a7a2-9317c384585a"],
Cell[7653, 207, 14327, 352, 766, "Input",ExpressionUUID->"15b01b56-b5d5-4c93-8a66-aa3e1040cc0f"],
Cell[CellGroupData[{
Cell[22005, 563, 276, 5, 30, "Input",ExpressionUUID->"2cf6c92a-5e6a-46be-bd85-0aabbe25cd83"],
Cell[22284, 570, 282, 6, 34, "Output",ExpressionUUID->"9a2b383d-3f13-4ff4-b44c-b58d9da53153"]
}, Open  ]],
Cell[22581, 579, 371, 6, 30, "Input",ExpressionUUID->"9583f919-2f58-40d5-a649-096a77c66b72"],
Cell[22955, 587, 885, 13, 52, "Input",ExpressionUUID->"c1aab33d-79f2-4d4d-b9c1-255a2007c81b"],
Cell[23843, 602, 194, 3, 52, "Input",ExpressionUUID->"34e01d77-a8ae-4b18-83c0-b4ca1b80292d"],
Cell[CellGroupData[{
Cell[24062, 609, 854, 23, 30, "Input",ExpressionUUID->"245dd2ea-c2aa-4dab-a94f-90939702aa79"],
Cell[24919, 634, 633, 12, 34, "Output",ExpressionUUID->"e943b341-555e-4285-83c3-e71880476e28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25589, 651, 1543, 33, 115, "Input",ExpressionUUID->"7ce1c9c3-1195-4f14-85fb-327189b3df86"],
Cell[27135, 686, 3384, 79, 261, "Output",ExpressionUUID->"84132dce-0393-4d92-8050-0c444c562821"]
}, Open  ]],
Cell[30534, 768, 154, 3, 30, "Input",ExpressionUUID->"bf0ac399-7d82-4dd8-8be6-81cf12a072e4"],
Cell[30691, 773, 826, 21, 52, "Input",ExpressionUUID->"0d281b3e-0c42-4ff3-80a9-abadabe2f68e"]
}, Open  ]]
}
]
*)

